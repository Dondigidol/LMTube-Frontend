(this["webpackJsonplmtube-react-app"]=this["webpackJsonplmtube-react-app"]||[]).push([[0],{62:function(e,t,a){e.exports=a(96)},67:function(e,t,a){},95:function(e,t,a){},96:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(18),i=a.n(o),c=(a(67),a(6)),s=a(7),l=a(9),u=a(8),d=(a(68),a(60)),m=a(28),p=function(e){return r.a.createElement("form",{className:"form-inline my-2 my-lg-0",onSubmit:e.searchingMethod},r.a.createElement("input",{className:"form-control mr-sm-2",type:"text",placeholder:"\u041f\u043e\u0438\u0441\u043a",name:"mask"}))},v=a(4),h=a(13),f=a.n(h),E=a(23),b=a(14),y=a.n(b),g=function(e){e?y.a.defaults.headers.common.Authorization=e:delete y.a.defaults.headers.common.Authorization},O=a(36),w=a.n(O),N=function(){return function(e){localStorage.removeItem("jwtToken"),g(!1),e({type:"SET_CURRENT_USER",payload:{}})}},j=a(5),k=a.n(j),T=[["\u0413\u043b\u0430\u0432\u043d\u0430\u044f","/",0,!0],["\u041c\u043e\u0438 \u0432\u0438\u0434\u0435\u043e","/user-videos",1,!1],["\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c","/uploading",1,!1],["\u041c\u043e\u0434\u0435\u0440\u0430\u0446\u0438\u044f","/moderation",2,!0]],R=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).componentDidMount=function(){var e=window.location.pathname;T.forEach((function(t){t[1]===e&&t[3]&&n.setState({searchEnabled:!0})}))},n.menuButtonClick=function(){var e=n.menu.current;""===e.style.display||"none"===e.style.display?e.style.display="block":"block"===e.style.display&&(e.style.display="")},n.state={searchEnabled:!1},n.menu=r.a.createRef(),n}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.security,a=t.validToken,n=t.user,o=window.location.pathname,i=0;switch(n.role){case"CREATOR":i=1;break;case"MODERATOR":i=2;break;case"ADMINISTRATOR":i=3}var c,s=r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",ref:this.menu},r.a.createElement("ul",{className:"navbar-nav mr-auto"},T.map((function(e){return e[2]<=i&&r.a.createElement("li",{key:e[0],className:"nav-item"},r.a.createElement("a",{className:k()("nav-link active",{"nav-link text-muted font-weight-lighter":e[1]!==o}),href:e[1]},e[0]))}))),this.state.searchEnabled&&r.a.createElement(p,{searchingMethod:this.props.searchingMethod})),l=r.a.createElement("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",ref:this.menu},r.a.createElement("ul",{className:"navbar-nav mr-auto"},T.map((function(e){return 0===e[2]&&r.a.createElement("li",{key:e[0],className:"nav-item"},r.a.createElement("a",{className:k()("nav-link active",{"nav-link text-muted font-weight-lighter":e[1]!==o}),href:e[1]},e[0]))}))),this.state.searchEnabled&&r.a.createElement(p,{searchingMethod:this.props.searchingMethod}));return c=a&&n?s:l,r.a.createElement("div",null,r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light header-bg-color"},r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",onClick:this.menuButtonClick},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("a",{className:"navbar-brand",href:"/"},"LMPlay"),c,a?r.a.createElement("div",{className:"navbar-expand"},r.a.createElement("div",{className:"inline-block float-left text-muted text-center ml-3 mr-3"},r.a.createElement("div",{className:"small"},n.fullName),r.a.createElement("div",{className:"small m-0 p-0"},n.role)),r.a.createElement("div",{className:"inline-block float-right"},r.a.createElement("a",{className:"nav-link text-muted font-weight-lighter",href:"/",onClick:function(){return e.props.userLogout()}},"\u0412\u044b\u0439\u0442\u0438"))):r.a.createElement("div",{className:"navbar-nav"},r.a.createElement("a",{className:k()("nav-link active",{"nav-link text-muted font-weight-lighter":"/login"!==o}),href:"/login"},"\u0412\u043e\u0439\u0442\u0438"))))}}]),a}(r.a.Component),C=Object(v.b)((function(e){return{security:e.security}}),{userLogout:N})(R);y.a.defaults.baseURL="http://p-lmplay-as01:8080/lmplay/api";var S=function(e,t){return function(){var a=Object(E.a)(f.a.mark((function a(n){var r;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,y.a.get("/video/videos?title=".concat(e,"&available=").concat(t));case 2:r=a.sent,n({type:"GET_VIDEOS",payload:r.data});case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()},x=function(e){return function(){var t=Object(E.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.a.get("/video/".concat(e));case 3:(n=t.sent).data&&a({type:"GET_SELECTED_VIDEO",payload:n.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a({type:"GET_ERRORS",payload:t.t0.response.data});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()},I=function(e){return e?y.a.defaults.baseURL+"/poster/".concat(e):null},D=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={width:0},e.componentDidMount=function(){e.setState({width:e.posterContainer.clientWidth})},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this,t=this.props.posterId,a=I(t);return r.a.createElement("div",{ref:function(t){return e.posterContainer=t},style:{height:.7*this.state.width}},r.a.createElement("img",{className:"poster",src:a,alt:this.props.alt}))}}]),a}(r.a.Component),A=function(e){var t="/video/"+e.video.id;return r.a.createElement("a",{className:"nav-link text-muted",href:t,poster:e.video.poster.id},r.a.createElement("div",{className:"videoPreview card-body"},!e.video.available&&r.a.createElement("div",{className:"badge badge-pill badge-warning position-absolute font-weight-light mt-1 ml-1"},"\u043d\u0435 \u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u043d\u043e"),r.a.createElement("div",null,r.a.createElement(D,{posterId:e.video.poster.id,alt:e.video.title})),r.a.createElement("p",{className:"text-center font-weight-bold"},e.video.title),r.a.createElement("small",{className:"muted"},r.a.createElement("div",null,"\u0410\u0432\u0442\u043e\u0440:"," ",e.video.author&&e.video.author.fullName?e.video.author.fullName:"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u0435\u043d"),r.a.createElement("div",null,"\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d: ",e.video.createdAt),r.a.createElement("div",null,"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u043e\u0432: ",e.video.views))))},M=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).searchingVideo=function(t){t.preventDefault();var a=t.target.elements.mask.value;e.props.getVideos(a,!0)},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.getVideos("",!0)}},{key:"render",value:function(){var e=this.props.videos.videos;return r.a.createElement("div",null,r.a.createElement(C,{searchingMethod:this.searchingVideo}),r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row pt-3"},e.map((function(e){return r.a.createElement("div",{key:e.id,className:"col-sm-12 col-md-4 col-lg-3 videoPreview"},r.a.createElement(A,{video:e}))})))))}}]),a}(r.a.Component),_=Object(v.b)((function(e){return{videos:e.videos}}),{getVideos:S})(M),V=a(56),F=a.n(V),P=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"createPlayer",value:function(){var e=this.props.video,t=I(e.poster.id),a=[];e.videos.forEach((function(e){var t,n,r={src:(t=e.resolution,n=e.name,t&&n?y.a.defaults.baseURL+"/video/stream/".concat(t,"/").concat(n):null),type:e.mimeType,size:e.resolution};a.push(r)}));var n=new F.a(document.getElementById("player"),{title:e.title,controls:["play-large","play","progress","current-time","mute","volume","settings","fullscreen"],settings:["quality","speed"],autoplay:this.props.autoplay,autopause:!0,clickToPlay:!0,hideControls:!0,fullscreen:{enabled:!0}});n.source={type:"video",title:e.title,sources:a,poster:t},n.quality={default:"480"}}},{key:"componentDidMount",value:function(){this.createPlayer()}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("video",{id:"player",preload:"auto",controls:!0,width:"auto",height:"100%"}))}}]),a}(r.a.Component),U=Object(v.b)((function(e){return{video:e.videos.video}}))(P),L=a(25),G=a(45),W=Object(v.b)((function(e){return{video:e.videos.video}}))((function(e){var t="<iframe title='"+e.video.title+"' "+"src='".concat(window.location.origin,"/embed/")+e.video.id+"' frameBorder='0' height= '300' width='531' allowfullscreen />";return r.a.createElement(G.a,{show:e.show,animation:!1,onHide:e.hide},r.a.createElement(G.a.Body,null,r.a.createElement("p",null,"\u0421\u043a\u043e\u043f\u0438\u0440\u0443\u0439\u0442\u0435 \u0442\u0435\u043a\u0441\u0442 \u0432 \u043d\u0435\u043e\u0431\u0445\u043e\u0434\u0438\u043c\u0443\u044e \u0441\u0442\u0440\u0430\u043d\u0438\u0446\u0443"),r.a.createElement("textarea",{className:"form-control w-100",defaultValue:t,rows:"3",style:{fontSize:"0.8em"}})))})),B=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).updateAvailability=function(t){e.props.setAvailability(e.props.video.id,t)},e}return Object(s.a)(a,[{key:"render",value:function(){var e=this;switch(this.props.user.role){case"ADMINISTRATOR":case"MODERATOR":return this.props.video.available?r.a.createElement("div",{onClick:function(){return e.updateAvailability(!1)}},"\u0441\u043d\u044f\u0442\u044c \u0441 \u043f\u0443\u0431\u043b\u0438\u043a\u0430\u0446\u0438\u0438"):r.a.createElement("div",{onClick:function(){return e.updateAvailability(!0)}},"\u043e\u043f\u0443\u0431\u043b\u0438\u043a\u043e\u0432\u0430\u0442\u044c");default:return null}}}]),a}(r.a.Component),z=Object(v.b)((function(e){return{video:e.videos.video,user:e.security.user}}),{setAvailability:function(e,t){return function(){var a=Object(E.a)(f.a.mark((function a(n){var r;return f.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,y.a.post("/video/availability?id=".concat(e,"&available=").concat(t));case 2:r=a.sent,n({type:"GET_SELECTED_VIDEO",payload:r.data});case 4:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}()}})(B),X=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"redirectToEditPage",value:function(){window.location.href="/edit/".concat(this.props.video.id)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{onClick:function(){return e.redirectToEditPage()}},"\u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c")}}]),a}(r.a.Component),q=Object(v.b)((function(e){return{video:e.videos.video}}))(X),J=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={showIframePopup:!1},e.showIframePopup=function(){e.setState({showIframePopup:!0})},e.hideIframePopup=function(){e.setState({showIframePopup:!1})},e}return Object(s.a)(a,[{key:"getMenuItems",value:function(){var e=[];switch(this.props.user.role){case"ADMINISTRATOR":case"MODERATOR":e.push(r.a.createElement(L.a.Item,{onClick:this.showIframePopup},"\u0432\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0432\u0438\u0434\u0435\u043e")),e.push(r.a.createElement(L.a.Item,null,r.a.createElement(z,null))),e.push(r.a.createElement(L.a.Item,null,r.a.createElement(q,null)));break;case"CREATOR":e.push(r.a.createElement(L.a.Item,{onClick:this.showIframePopup},"\u0432\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0432\u0438\u0434\u0435\u043e"));var t=this.props.video.author?this.props.video.author.username:"",a=this.props.user.username;void 0!==a&&a===t&&e.push(r.a.createElement(L.a.Item,null,r.a.createElement(q,null)));break;default:e.push(r.a.createElement(L.a.Item,{onClick:this.showIframePopup},"\u0432\u0441\u0442\u0440\u043e\u0438\u0442\u044c \u0432\u0438\u0434\u0435\u043e"))}return e}},{key:"render",value:function(){var e=this.getMenuItems();return r.a.createElement("div",null,r.a.createElement(W,{show:this.state.showIframePopup,hide:this.hideIframePopup}),r.a.createElement(L.a,null,r.a.createElement(L.a.Toggle,{className:"btn-sm mt-1 float-right btn-outline-light",style:{fontSize:"0.8em",backgroundColor:"#50c779"}},"\u041c\u0435\u043d\u044e"),r.a.createElement(L.a.Menu,{style:{fontSize:"0.8em"}},e.map((function(e,t,a){return r.a.createElement("div",{key:t},e)})))))}}]),a}(r.a.Component),H=Object(v.b)((function(e){return{user:e.security.user,video:e.videos.video}}))(J),$=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"col-sm-12 pt-3"},r.a.createElement("div",null,r.a.createElement(U,null)),!this.props.video.available&&r.a.createElement("div",{className:"alert alert-warning"},"\u0412 \u043d\u0430\u0441\u0442\u043e\u044f\u0449\u0435\u0435 \u0432\u0440\u0435\u043c\u044f \u0432\u0438\u0434\u0435\u043e \u0441\u043d\u044f\u0442\u043e \u0441 \u043f\u0443\u043b\u0438\u043a\u0430\u0446\u0438\u0438."),r.a.createElement(H,null),r.a.createElement("div",null,r.a.createElement("h4",null,this.props.video.title)),r.a.createElement("small",{className:"text-muted"},r.a.createElement("div",{className:"d-inline"},"\u0410\u0432\u0442\u043e\u0440:"," ",this.props.video.author&&this.props.video.author.fullName?this.props.video.author.fullName:"\u041d\u0435\u0438\u0437\u0432\u0435\u0441\u0442\u0435\u043d"),r.a.createElement("div",{className:"d-inline float-right"},"\u0417\u0430\u0433\u0440\u0443\u0436\u0435\u043d\u043e: ",this.props.video.createdAt),r.a.createElement("div",null,"\u041f\u0440\u043e\u0441\u043c\u043e\u0442\u0440\u043e\u0432: ",this.props.video.views)),r.a.createElement("hr",null),r.a.createElement("div",{className:""},this.props.video.description))}}]),a}(r.a.Component),K=Object(v.b)((function(e){return{video:e.videos.video}}))($),Q=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.video;return e!==this.video&&(this.video=e,e.id?this.props.getRecommendations(e.id):this.props.getRecommendations(-1)),r.a.createElement("div",null,r.a.createElement("p",{className:"breadcrumb breadcrumb-item active mt-3"},"\u0420\u0435\u043a\u043e\u043c\u0435\u043d\u0434\u0430\u0446\u0438\u0438"),this.props.recommendations.map((function(e){return r.a.createElement("div",{key:e.id,className:"videoPreview"},r.a.createElement(A,{video:e}))})))}}]),a}(r.a.Component),Y=Object(v.b)((function(e){return{video:e.videos.video,errors:e.errors,recommendations:e.videos.recommendations}}),{getRecommendations:function(e){return function(){var t=Object(E.a)(f.a.mark((function t(a){var n;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,y.a.get(y.a.defaults.baseURL+"/video/recommendations/".concat(e));case 3:(n=t.sent).data&&a({type:"GET_RECOMMENDATIONS",payload:n.data}),t.next=10;break;case 7:t.prev=7,t.t0=t.catch(0),a({type:"GET_ERRORS",payload:t.t0.response.data});case 10:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e){return t.apply(this,arguments)}}()}})(Q),Z=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).cont=r.a.createRef(),n.state={clientWidth:0},n}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.setState({clientWidth:this.cont.current.clientWidth})}},{key:"render",value:function(){return r.a.createElement("div",{className:"container"},r.a.createElement("div",{ref:this.cont,className:"row text-secondary",style:{height:.56*this.state.clientWidth}},r.a.createElement("div",{className:"my-auto col-12 text-center"},r.a.createElement("p",{className:"h4"},"\u0423\u043f\u0441..."),this.props.error.message)))}}]),a}(r.a.Component),ee=Object(v.b)((function(e){return{error:e.errors}}))(Z),te=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(c.a)(this,a);var r=(n=t.call(this,e)).props.match.params.videoId;return void 0!==r&&n.props.getVideo(r),n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.error.message;return r.a.createElement("div",null,r.a.createElement(C,null),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row"},r.a.createElement("div",{className:"col-12 col-lg-8"},e?r.a.createElement(ee,null):this.props.video.id&&r.a.createElement(K,null)),r.a.createElement("div",{className:"col-12 col-lg-4"},r.a.createElement(Y,null)))))}}]),a}(r.a.Component),ae=Object(v.b)((function(e){return{video:e.videos.video,error:e.errors}}),{getVideo:x})(te),ne=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){var e;Object(c.a)(this,a);for(var n=arguments.length,r=new Array(n),o=0;o<n;o++)r[o]=arguments[o];return(e=t.call.apply(t,[this].concat(r))).state={videos:[]},e}return Object(s.a)(a,[{key:"componentDidMount",value:function(){this.props.getUserVideos()}},{key:"componentDidUpdate",value:function(e){e.videos&&e.videos!==this.state.videos&&this.setState({videos:e.videos})}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(C,{searchingMethod:this.searchingVideo}),r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row pt-3"},this.state.videos?this.state.videos.map((function(e){return r.a.createElement("div",{key:e.id,className:"col-sm-12 col-md-4 col-lg-3 videoPreview"},r.a.createElement(A,{video:e}))})):{})))}}]),a}(r.a.Component),re=Object(v.b)((function(e){return{videos:e.videos.videos}}),{getUserVideos:function(){return function(){var e=Object(E.a)(f.a.mark((function e(t){var a;return f.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y.a.get("/user/videos");case 2:a=e.sent,t({type:"GET_VIDEOS",payload:a.data});case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()}})(ne),oe=a(26),ie=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).onChange=function(e){n.setState(Object(oe.a)({},e.target.name,e.target.value))},n.onLogin=function(e){e.preventDefault();var t={username:n.state.username,password:n.state.password};n.props.userAuthentication(t)},n.state={username:"",password:"",errors:{}},n.props.security.validToken&&(window.location.href="/"),n}return Object(s.a)(a,[{key:"componentWillReceiveProps",value:function(e){e.errors&&this.setState({errors:e.errors})}},{key:"render",value:function(){var e=this.state.errors;if(!this.props.security.validToken)return r.a.createElement("div",null,r.a.createElement(C,null),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-12 col-md-4 position-absolute login-form "},r.a.createElement("form",{onSubmit:this.onLogin},r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"text",className:k()("form-control",{"is-invalid":e.username}),placeholder:"\u041b\u0414\u0410\u041f",value:this.state.username,name:"username",onChange:this.onChange}),e.username&&r.a.createElement("div",{className:"invalid-feedback"},e.username)),r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{type:"password",className:k()("form-control",{"is-invalid":e.password}),name:"password",value:this.state.password,onChange:this.onChange,placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c"}),e.password&&r.a.createElement("div",{className:"invalid-feedback"},e.password)),r.a.createElement("div",{className:"form-group text-center"},r.a.createElement("button",{className:"btn btn-success btn-primary btn-lg",type:"submit"},"\u0412\u043e\u0439\u0442\u0438")))))));window.location.href="/"}}]),a}(r.a.Component),ce=Object(v.b)((function(e){return{security:e.security,errors:e.errors}}),{userAuthentication:function(e){return function(){var t=Object(E.a)(f.a.mark((function t(a){var n,r,o,i,c;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,n={headers:{"Content-Type":"application/json"}},r={username:e.username,password:e.password},t.next=5,y.a.post("/user/login",r,n);case 5:o=t.sent,i=o.data.token,localStorage.setItem("jwtToken",i),g(i),c=w()(i),a({type:"SET_CURRENT_USER",payload:c}),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(0),a({type:"GET_ERRORS",payload:t.t0.response.data});case 16:case"end":return t.stop()}}),t,null,[[0,13]])})));return function(e){return t.apply(this,arguments)}}()}})(ie),se=a(20),le=a(59),ue={},de=a(29),me={videos:[],video:{},recommendations:[]},pe={user:{},validToken:!1},ve=function(e){return!!e},he=Object(se.c)({errors:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ue,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_ERRORS":return t.payload;default:return e}},videos:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:me,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"GET_VIDEOS":return Object(de.a)({},e,{videos:t.payload});case"GET_SELECTED_VIDEO":return Object(de.a)({},e,{video:t.payload});case"GET_RECOMMENDATIONS":return Object(de.a)({},e,{recommendations:t.payload});default:return e}},security:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:pe,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"SET_CURRENT_USER":return Object(de.a)({},e,{validToken:ve(t.payload),user:t.payload});default:return e}}}),fe={},Ee=[le.a],be=window.navigator.userAgent.includes("Chrome")?Object(se.e)(he,fe,Object(se.d)(se.a.apply(void 0,Ee),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__())):Object(se.e)(he,fe,Object(se.d)(se.a.apply(void 0,Ee))),ye=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).props.getVideo(n.props.match.params.videoId),n.state={video:void 0},n}return Object(s.a)(a,[{key:"componentDidUpdate",value:function(e){e.video&&e.video!==this.state.video&&this.setState({video:e.video})}},{key:"render",value:function(){return r.a.createElement("div",null,this.props.error.message?r.a.createElement(ee,null):this.state.video&&r.a.createElement(U,null))}}]),a}(r.a.Component),ge=Object(v.b)((function(e){return{video:e.videos.video,error:e.errors}}),{getVideo:x})(ye),Oe=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;switch(Object(c.a)(this,a),(n=t.call(this,e)).searchingVideo=function(e){e.preventDefault();var t=e.target.elements.mask.value;n.props.getVideos(t,!1)},n.componentDidMount=function(){n.props.getVideos("",!1)},e.validToken||(window.location.href="/login"),e.user.role){case"ADMINISTRATOR":case"MODERATOR":break;default:window.location.href="/"}return n}return Object(s.a)(a,[{key:"render",value:function(){var e=this.props.videos.videos;return r.a.createElement("div",null,r.a.createElement(C,{searchingMethod:this.searchingVideo}),r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row pt-3"},e.map((function(e){return r.a.createElement("div",{key:e.id,className:"col-sm-12 col-md-4 col-lg-3 videoPreview"},r.a.createElement(A,{video:e}))})))))}}]),a}(r.a.Component),we=Object(v.b)((function(e){return{videos:e.videos,user:e.security.user,validToken:e.security.validToken}}),{getVideos:S})(Oe),Ne=function(){return r.a.createElement("div",null,r.a.createElement(C,null),r.a.createElement("div",{className:"mt-3 row text-secondary"},r.a.createElement("div",{className:"my-auto col-12 text-center"},r.a.createElement("p",{className:"h4"},"\u0423\u043f\u0441..."),"\u0421\u0442\u0440\u0430\u043d\u0438\u0446\u0430 \u043d\u0435 \u043d\u0430\u0439\u0434\u0435\u043d\u0430.")))},je=function(e){return e.show?r.a.createElement("div",{className:"loader"},r.a.createElement("div",{className:"spinner-border loader-spinner text-success",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading..."))):""},ke=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).submitForm=function(e){e.preventDefault();var t={title:n.state.title,description:n.state.description,videoFile:n.state.videoFile,posterFile:n.state.posterFile};n.props.uploadVideoDetails(t,n.props.history),n.setState({showLoader:!0})},n.onChange=function(e){n.setState(Object(oe.a)({},e.target.name,e.target.value))},n.onSelectFile=function(e){n.setState(Object(oe.a)({},e.target.name,e.target.files[0]))},n.state={title:"",description:"",videoFile:{},posterFile:{},showLoader:!1},n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(){return this.state.showLoader&&this.setState({showLoader:!1}),!0}},{key:"render",value:function(){var e=this.props.errors;return r.a.createElement("div",{className:"container"},r.a.createElement(je,{show:this.state.showLoader}),r.a.createElement("p",{className:"h4 text-center text-secondary"},"\u0417\u0430\u0433\u0440\u0443\u0437\u043a\u0430 \u0432\u0438\u0434\u0435\u043e"),r.a.createElement("form",{className:"text-left col-8 offset-2",onSubmit:this.submitForm,encType:"multipart/form-data"},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"title"},"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a"),r.a.createElement("input",{type:"text",className:k()("form-control",{"is-invalid":e.title}),id:"title",name:"title",onChange:this.onChange}),e.title&&r.a.createElement("div",{className:"invalid-feedback"},e.title),r.a.createElement("small",{className:"text-muted"},"* \u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043a\u043e\u0440\u043e\u0442\u043a\u0438\u043c, \u043d\u043e \u0442\u043e\u0447\u043d\u043e \u043e\u0442\u0440\u0430\u0436\u0430\u044e\u0449\u0438\u043c \u0441\u0443\u0442\u044c \u0432\u0438\u0434\u0435\u043e")),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"description"},"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043a \u0432\u0438\u0434\u0435\u043e"),r.a.createElement("textarea",{className:k()("form-control",{"is-invalid":e.description}),name:"description",id:"description",onChange:this.onChange,rows:"5"}),e.description&&r.a.createElement("div",{className:"invalid-feedback"},e.description),r.a.createElement("small",{className:"text-muted"},"* \u041a\u043e\u0440\u043e\u0442\u043a\u043e\u0435, \u043d\u043e \u0451\u043c\u043a\u043e\u0435 \u043f\u043e \u0441\u043c\u044b\u0441\u043b\u0443 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0437\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c\u043e\u0433\u043e \u0432\u0438\u0434\u0435\u043e")),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"videoFile"},"\u0412\u0438\u0434\u0435\u043e\u0444\u0430\u0439\u043b"),r.a.createElement("input",{type:"file",name:"videoFile",id:"videoFile",className:"form-control-file",onChange:this.onSelectFile,accept:"video/*"}),e.videoFile&&r.a.createElement("div",{className:"invalid-feedback d-block"},e.videoFile)),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"posterFile"},"\u041f\u043e\u0441\u0442\u0435\u0440 \u043a \u0432\u0438\u0434\u0435\u043e"),r.a.createElement("input",{type:"file",name:"posterFile",id:"posterFile",className:"form-control-file",onChange:this.onSelectFile,accept:"image/*"}),e.posterFile&&r.a.createElement("div",{className:"invalid-feedback d-block"},e.posterFile)),r.a.createElement("div",{className:"text-center"},r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-success btn-lg"},"\u0417\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044c"))))}}]),a}(n.Component),Te=Object(v.b)((function(e){return{errors:e.errors,user:e.security.user,validToken:e.security.validToken}}),{uploadVideoDetails:function(e,t){return function(){var t=Object(E.a)(f.a.mark((function t(a){var n,r;return f.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,(n=new FormData).append("title",e.title),n.append("description",e.description),n.append("videoFile",e.videoFile),n.append("posterFile",e.posterFile),r={headers:{"Content-Type":"multipart/form-data"}},t.next=9,y.a.post("/video/upload",n,r);case 9:window.location.href="/user-videos",t.next=15;break;case 12:t.prev=12,t.t0=t.catch(0),a({type:"GET_ERRORS",payload:t.t0.response.data});case 15:case"end":return t.stop()}}),t,null,[[0,12]])})));return function(e){return t.apply(this,arguments)}}()}})(ke),Re=Object(v.b)((function(e){return{validToken:e.security.validToken}}))((function(e){if(e.validToken)return r.a.createElement("div",null,r.a.createElement(C,null),r.a.createElement(Te,null));window.location.href="/login"})),Ce=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;Object(c.a)(this,a);var r=(n=t.call(this,e)).props.match.params.videoId;return n.state={videoId:r,video:{}},void 0!==r&&n.props.getVideo(r),n}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"col-12 col-lg-8"},r.a.createElement(K,null)))}}]),a}(r.a.Component),Se=Object(v.b)((function(e){return{video:e.videos.video}}),{getVideo:x})(Ce),xe={ADMINISTRATOR:"ADMINISTRATOR",MODERATOR:"MODERATOR",CREATOR:"CREATOR"},Ie=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(e){var n;switch(Object(c.a)(this,a),(n=t.call(this,e)).onChange=function(e){n.setState(Object(oe.a)({},e.target.name,e.target.value))},n.onSubmit=function(e){e.preventDefault();var t=n.props.match.params.videoId,a=n.state.title,r=n.state.description;n.props.editVideo(t,a,r)},n.props.validToken||(window.location.href="/404"),n.props.user.role){case xe.ADMINISTRATOR:case xe.MODERATOR:case xe.CREATOR:n.props.getVideo(n.props.match.params.videoId);break;default:window.location.href="/404"}return n.state={title:"",description:"",titleIsEdited:!1,descriptionIsEdited:!1,errors:{},video:void 0},n.title=r.a.createRef(),n.description=r.a.createRef(),n}return Object(s.a)(a,[{key:"shouldComponentUpdate",value:function(e,t){return e.video&&e.video!==t.video&&this.setState({video:e.video}),!0}},{key:"componentDidUpdate",value:function(e){e.video.id&&(e.user.role===xe.CREATOR&&e.video.author.username!==e.user.username&&(window.location.href="/404"),""!==this.title.current.value||this.state.titleIsEdited||(this.title.current.value=e.video.title,this.setState({title:this.title.current.value,titleIsEdited:!0})),""!==this.description.current.value||this.state.descriptionIsEdited||(this.description.current.value=e.video.description,this.setState({description:this.description.current.value,descriptionIsEdited:!0})))}},{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(C,null),r.a.createElement("div",{className:"row"},this.props.errors.message?r.a.createElement("div",{className:"col-12 text-center mt-4 text-secondary"},this.props.errors.message):this.props.video.id&&r.a.createElement("div",{className:"my-auto col-8 offset-2"},r.a.createElement("form",{onSubmit:this.onSubmit},r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"title"},"\u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a"),r.a.createElement("input",{type:"text",className:k()("form-control",{"is-invalid":this.props.errors.title}),name:"title",ref:this.title,value:this.state.title,onChange:this.onChange}),this.props.errors.title&&r.a.createElement("div",{className:"invalid-feedback"},this.props.errors.title),r.a.createElement("small",{className:"text-muted"},"* \u0417\u0430\u0433\u043e\u043b\u043e\u0432\u043e\u043a \u0434\u043e\u043b\u0436\u0435\u043d \u0431\u044b\u0442\u044c \u043a\u043e\u0440\u043e\u0442\u043a\u0438\u043c, \u043d\u043e \u0442\u043e\u0447\u043d\u043e \u043e\u0442\u0440\u0430\u0436\u0430\u044e\u0449\u0438\u043c \u0441\u0443\u0442\u044c \u0432\u0438\u0434\u0435\u043e")),r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{htmlFor:"description"},"\u041e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u043a \u0432\u0438\u0434\u0435\u043e"),r.a.createElement("textarea",{className:k()("form-control",{"is-invalid":this.props.errors.description}),ref:this.description,value:this.state.description,name:"description",rows:"5",onChange:this.onChange}),this.props.errors.description&&r.a.createElement("div",{className:"invalid-feedback"},this.props.errors.description),r.a.createElement("small",{className:"text-muted"},"* \u041a\u043e\u0440\u043e\u0442\u043a\u043e\u0435, \u043d\u043e \u0451\u043c\u043a\u043e\u0435 \u043f\u043e \u0441\u043c\u044b\u0441\u043b\u0443 \u043e\u043f\u0438\u0441\u0430\u043d\u0438\u0435 \u0432\u0438\u0434\u0435\u043e")),r.a.createElement("div",{className:"text-center"},r.a.createElement("button",{type:"submit",className:"btn btn-primary btn-success btn-lg"},"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c"))))))}}]),a}(r.a.Component),De=Object(v.b)((function(e){return{video:e.videos.video,user:e.security.user,errors:e.errors,validToken:e.security.validToken}}),{getVideo:x,editVideo:function(e,t,a){return function(){var n=Object(E.a)(f.a.mark((function n(r){var o,i;return f.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,o={id:e,title:t,description:a},i={headers:{"Content-Type":"application/json"}},n.next=5,y.a.post("/video/edit",o,i);case 5:window.location.href="/video/".concat(e),n.next=11;break;case 8:n.prev=8,n.t0=n.catch(0),r({type:"GET_ERRORS",payload:n.t0.response.data});case 11:case"end":return n.stop()}}),n,null,[[0,8]])})));return function(e){return n.apply(this,arguments)}}()}})(Ie),Ae=localStorage.jwtToken;if(Ae){g(Ae);var Me=w()(Ae);be.dispatch({type:"SET_CURRENT_USER",payload:Me});var _e=Date.now()/1e3;Me.exp<_e&&(be.dispatch(N()),window.location.href="/")}var Ve=function(e){Object(l.a)(a,e);var t=Object(u.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(s.a)(a,[{key:"render",value:function(){return r.a.createElement(v.a,{store:be},r.a.createElement("div",{className:"App"},r.a.createElement(d.a,null,r.a.createElement(m.d,null,r.a.createElement(m.b,{exact:!0,path:"/",component:_}),r.a.createElement(m.b,{exact:!0,path:"/login",component:ce}),r.a.createElement(m.b,{exact:!0,path:"/video/:videoId",component:ae}),r.a.createElement(m.b,{exact:!0,path:"/embed/:videoId",component:ge}),r.a.createElement(m.b,{exact:!0,path:"/uploading",component:Re}),r.a.createElement(m.b,{exact:!0,path:"/user-videos",component:re}),r.a.createElement(m.b,{exact:!0,path:"/moderation",component:we}),r.a.createElement(m.b,{exact:!0,path:"/edit/:videoId",component:De}),r.a.createElement(m.b,{exact:!0,path:"/test/:videoId",component:Se}),r.a.createElement(m.b,{exact:!0,path:"/404",component:Ne}),r.a.createElement(m.a,{from:"*",to:"/404"})))))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));a(95);i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(Ve,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[62,1,2]]]);
//# sourceMappingURL=main.c0fcec84.chunk.js.map